<p>最近、普段遣いの言語としてNimや<a class="keyword" href="https://d.hatena.ne.jp/keyword/Haxe">Haxe</a>への探求を再開している。元々は<a href="https://c3-lang.org/">C3</a>という言語を知ってワクワクしていたのだけれど、改めてスマートポインタなどがない環境で自分がやっていけるかがやや不安になった。まぁ参照カウントを手製でつければいいといえばいいのだけれど、前からずっと期待していたNimがもう2.2.0になっていることを考えて、そろそろNimを本格的に使っていってもいいのではないかという期待感もある。</p>

<p>Nimを本格的に使うとすれば、不安なのはバイナリサイズか。Cを出力するトランスパイル言語であるために、<a class="keyword" href="https://d.hatena.ne.jp/keyword/GC">GC</a>まで内包するとなると、出力するバイナリのサイズが大きくなることが予想される。</p>

<p>そもそも自分の理想とする言語を一度明言化しておくと、</p>

<ul>
<li>できるだけ普通の言語で、新しい人が参加したときに障壁が少ない</li>
<li>メモリ管理は手動でもでき自動でもできると理想。<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>のスマートポインタくらいのバランス感覚が良い。</li>
<li>目的遂行のために、余計なことを考えなくて済むほうが良い。例えば過剰にメモリやポインタなどの実装のことを気にしなければならなかったり、表現力に制限があったり、実装したは良いものの速度が遅かったり、Stop-the-worldの<a class="keyword" href="https://d.hatena.ne.jp/keyword/GC">GC</a>に悩まされたりすると辛い。</li>
</ul>


<p>この基準だと、Rustや<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>は少し辛い。Zigは実装を気にしなければならなすぎる点が気になる。<a class="keyword" href="https://d.hatena.ne.jp/keyword/Python">Python</a>などは実装したものが速度が遅すぎたりすることが度々ある。</p>

<p>その点、例えばGodotのように、普段はGDScriptなどの<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8">スクリプト</a>を書いておいて、最適化やハードの連携が必要な部分だけを<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>で書くという棲み分けは結構好みだったりする。この両者を1つの言語で書ければという理想が常にある。</p>

<p><a class="keyword" href="https://d.hatena.ne.jp/keyword/C%23">C#</a>でも良いのだけれど、<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%AF%A5%ED%A5%B9%A5%D7%A5%E9%A5%C3%A5%C8%A5%D5%A5%A9%A1%BC%A5%E0">クロスプラットフォーム</a>で<a class="keyword" href="https://d.hatena.ne.jp/keyword/GUI">GUI</a>が書けたりするような部分に少し不安がある。MAUIなどがあることは理解はしているけれど、いざとなったら<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>などとブリッジしなければならないかもしれないことを考えると、少し躊躇してしまうし、今の<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%AF%A5%ED%A5%B9%A5%D7%A5%E9%A5%C3%A5%C8%A5%D5%A5%A9%A1%BC%A5%E0">クロスプラットフォーム</a>の流れが続くかどうかが<a class="keyword" href="https://d.hatena.ne.jp/keyword/Microsoft">Microsoft</a>に委ねられているというのはあまり良い気持ちはしない。</p>

<p>そうなってくると選択肢は<a class="keyword" href="https://d.hatena.ne.jp/keyword/Haxe">Haxe</a>やNimになってくるのだけれど、<a class="keyword" href="https://d.hatena.ne.jp/keyword/Haxe">Haxe</a>は過去に使った経験からどうしてもオーバーヘッドが気になる。それに比べるとNimはオーバーヘッドが少なそうではあるし、ターゲット言語が限られているので<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a> <a class="keyword" href="https://d.hatena.ne.jp/keyword/interop">interop</a>などが強そうなのは利点に思える。</p>

<p>あとはWrenなどの<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8%B8%C0%B8%EC">スクリプト言語</a>を<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>と連携させるというのも手ではあるし、<a class="keyword" href="https://d.hatena.ne.jp/keyword/Lua">Lua</a>を真剣に使おうと思っていた時期もあるけれど、<a class="keyword" href="https://d.hatena.ne.jp/keyword/Lua">Lua</a>は表現力的な部分と自分の思考に今ひとつマッチしない部分があって長く続かなかった（たまに書くことはある）。なので、<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8%B8%C0%B8%EC">スクリプト言語</a>と<a class="keyword" href="https://d.hatena.ne.jp/keyword/%A5%D0%A5%A4%A5%F3%A5%C7%A5%A3%A5%F3%A5%B0">バインディング</a>するくらいなら、一つの言語で書ければというところはある。</p>

<p>・・・こうやって書いていれば多少思考が整理されるかと思ったのだけれど、結局とりとめがない感じになってしまった。たぶん、Nimに関する知識と経験が不足しすぎているので、もう少し手になじませてから、考えてみたほうがいいかもしれない。</p>

<p><a href="https://vlang.io/">V言語</a>の<a href="https://www.reddit.com/r/ProgrammingLanguages/comments/14ua5dx/why_is_vlangs_autofree_model_not_more_widely_used/">autofree</a>が正式版になればV言語を検討してもよさそうな気もするし、<a href="https://vale.dev/">Vale</a>ももう少し安定すればとも思うけれど、この辺はまだ数年は様子見かな。</p>

<p>（追記：この記事を見直していたときに<a href="https://www.beeflang.org/">Beef</a>という<a class="keyword" href="https://d.hatena.ne.jp/keyword/C%23">C#</a>ライクな言語があることを知った。これももう少し調べてみよう。）</p>
